<h1>1. 配置思路</h1>

根据Ares的思想，整个app的第一层界面（“宿主”）是原生开发的，然后里面每个入口点击后进入子界面。

每个子界面都有一个门牌号（称为uri）来让“宿主”知道该从哪里下载对应功能的文件。本文以千米电商云APP为例，指导了如何配置和管理这个uri。

<img src="http://pic.qianmi.com/app/doc/overview.png" width=520 height=300/>

<h1>2. 千米电商云宿主结构</h1>

<img src="http://pic.qianmi.com/app/doc/app_workspace.png" width=250 height=450/>
<img src="http://pic.qianmi.com/app/doc/app_me.png" width=250 height=450/>

如上图，整个宿主界面的下方是一个tabbar，是【第一层】菜单，【工作台】、【发现】和【我的】是一级目录。

【工作台】中包含了一系列的菜单，比如左上角和右上角的两个按钮（扫码和消息），仪表盘，和九宫格里面的菜单；【发现】只含有一个菜单，填入一个网址即可；【我的】含有一系列的菜单，从【千米币】到【设置】，其实上方的个人信息也是菜单之一。

这样子，菜单的结构大概是：

<img src="http://pic.qianmi.com/app/doc/app_structure.png" width=350 height=250/>

对应CRM上的配置大致为：

<img src="http://pic.qianmi.com/app/doc/app_crm.png" width=250 height=650/>

<h1>3. 配置步骤</h1>

进入CRM->产品管理->场景管理->菜单，选择对应的场景对应的角色，**添加目录或者菜单时都必须要把适应平台设置为APP端**

#### 一级目录
>【工作台】【工作】【我的】三个即为一级目录，实际情况可以不同

|适应平台|权限唯一值|地址|图标|类型|
|:-----  |:-------|:-----|-----|------|
|APP端 | tab    |workspace、finder、me三选一|实际的字体图标unicode值|目录|

比如：

<img src="http://pic.qianmi.com/app/doc/app_workspace_mulu.png" width=510 height=330/>

#### 工作台菜单配置

* 工具栏按钮配置

>在工作台／我的 下面建立，比如【扫一扫】和【消息中心】，最终显示在工作台和我的页面上方的工具栏位置
>
>这里目前限制死最多只配置两个

|适应平台|权限唯一值|地址|图标|类型|
|:-----  |:-------|:-----|-----|------|
|APP端 | toolbar    |实际的uri|实际的字体图标unicode值|菜单|

* 仪表盘配置

>仪表盘比较特殊，属于一个数据+解释的形式，配置方式有所不同，也是在工作台下面建立菜单

|名称|适应平台|权限唯一值|地址|图标|类型|
|----|:-----  |:-------|:-----|-----|------|
|显示在仪表盘上的解释文字|APP端 | board    |获取该BI数据的API|可选|菜单|

比如：

<img src="http://pic.qianmi.com/app/doc/app_board.png" width=510 height=330/>


* 九宫格菜单

>在工作台下配置，注意排序字段，九宫格根据该字段进行前后排布

|名称|适应平台|权限唯一值|地址|图标|图标样式名称|类型|
|----|:-----  |:-------|:-----|-----|-----|------|
|实际菜单名称|APP端 | workspace   |实际的uri|实际的字体图标unicode值|图标颜色|菜单|
>图标样式名称目前可以配置四种： yellow、blue、green、red，直接填写英文单词


#### 发现配置
>发现实际是一个webview，只需要配置发现内容的网址即可，在【发现】里面加入一个菜单即可

|适应平台|权限唯一值|地址|图标|类型|
|:-----  |:-------|:-----|-----|------|
|APP端 | finder   |实际网址（电商云APP中填写的是BBS的移动版网页）|可选|菜单|

#### 我的菜单配置

* 个人信息入口配置
> 【我的】里面有个隐藏的菜单入口，即个人信息，即点击头像信息板时需要跳转的入口，也是在【我的】里面加入一个菜单

|名称|适应平台|权限唯一值|地址|图标|类型|
|----|:-----  |:-------|:-----|-----|------|
|个人信息|APP端 | info   |实际的uri|可选|菜单|


* 其他菜单（有分类）

|名称|适应平台|权限唯一值|地址|图标|图标样式名称|类型|
|----|:-----  |:-------|:-----|-----|----|------|
|实际菜单名称|APP端 | me/?   |实际的uri|实际的字体图标unicode值|图标颜色|菜单|
>图标样式名称目前可以配置四种： yellow、blue、green、red，直接填写英文单词
>
>这个菜单有个特殊的地方，我的菜单里面是分类的，比如【千米币】单独一类，【订购关系】和【千米小二】一类，以此类推，这里可以用me/?的问号拿数字代替，比如【订购关系】和【千米小二】可以设置为me/2

<img src="http://pic.qianmi.com/app/doc/app_me_number.png" width=250 height=450/>

<h1>4. 仪表盘BI数据地址接口配置</h1>

<img src="http://pic.qianmi.com/app/doc/board.png" width=450 height=320/>

每个角色的仪表盘数据按照【一主三从】的模式，这里以老板角色为例，解释配置菜单中如何配置【地址】一栏

首先在【工作台】下的菜单中的【仪表盘】目录中地址配置为：
admin_api:api/mobile/boss/home/getInfo

其基本格式为{host}:{api}

host说明了这个接口归属于哪个组件，admin-api即说明改接口从ADMIN-API获取，api则指示了具体哪个接口，这个接口的返回值的data参数是一个HashMap<String,Object>，其中每一项的Key就是配置在【仪表盘】的子菜单项目中的【地址】



<h1>5. APP管理系统</h1>

1. 选择环境
2. 在路由管理中选择合适的模块，新增一个路由，新增界面中的【路由】字段即上述的“门牌号”uri，这个字段一定要一一对应
3. 进入工程管理，选择电商云APP，点击编辑工程，将新增的路由加入本工程
4. 开发者对本路由进行打包（可以点击【打包帮助】查看环境id和工程id）
5. 进入工程管理，选择电商云APP，选择路由，可以看到刚才打包的版本，点击部署即可